---
title: "Spring Data JPA"
date: 2022-11-27
reading-time: "5 min read"
categories: java-spring-boot
image: https://cdn-images-1.medium.com/max/1024/0*DvGXoa58HQyWSsCi
---

[click here to read this in medium](https://guttikondaparthasai.medium.com/spring-data-jpa-59025a1e8894?source=rss-2c47946b91eb------2)

<p>Spring Data JPA provides repository support for the Jakarta Persistence API¬†(JPA).</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*DvGXoa58HQyWSsCi" /><figcaption>Photo by <a href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral">Markus Spiske</a> on¬†<a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption></figure><p>Spring Data JPA provides repository support for the Jakarta Persistence API(JPA).<br />It is used to improve the implementation of data access layers by reducing the efforts to the amount that‚Äôs actually¬†needed.</p><h4>‚õπÔ∏è‚Äç‚ôÇÔ∏èDependencies</h4><p>The below dependency needs to be in the build.gradle file.</p><pre>&lt;dependencies&gt;<br />  &lt;dependency&gt;<br />    &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;<br />    &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt;<br />  &lt;/dependency&gt;<br />&lt;dependencies&gt;</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*ElZrPV_QZakvEBkG" /><figcaption>Photo by <a href="https://unsplash.com/@tracycodes?utm_source=medium&amp;utm_medium=referral">Tracy Adams</a> on¬†<a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption></figure><h4>üôåüèªBasic concepts</h4><p>In general, We use CrudRepository for the CREATE, READ, UPDATE and DELETE operations and PagingAndSortingRepository for pagination and sort records. In JpaRepository provides JPA related methods such as flushing the persistence context and delete records in a batch. So JpaRepository inherities both the CrudRepository and PagingAndSorting.Addtional to that it gives a different methods to filter, save and query from the repository.</p><h4><strong>üëâCreating Repository Interface:</strong></h4><p>So in this interface we can give the method names and spring will take care of logic in it.<br />Note:- All the below example need to be inside these kind of interface which extends JpaRepository.</p><pre>@Repository<br />public interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {<br />    Product findByName(String productName);<br />}</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*eyw06rpTvdpY9C-T" /><figcaption>Photo by <a href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral">Aron Visuals</a> on¬†<a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption></figure><h3>üßû‚Äç‚ôÇÔ∏èMethods we can use in¬†JPA</h3><h4>CURD Operations and PagingAndSorting Operations:</h4><pre>&lt;S extends T&gt; S save(S entity); //--&gt;save entity to DB<br />Optional&lt;T&gt; findById(ID primaryKey); //--&gt;find entity from DB<br />Iterable&lt;T&gt; findAll();//--&gt;get ALL<br />long count();//--&gt; get count of entities<br />void delete(T entity);// --&gt; delete an entity<br />boolean existsById(ID primaryKey);// --&gt; is exist by ID<br /><br />Iterable&lt;T&gt; findAll(Sort sort);<br />Page&lt;T&gt; findAll(Pageable pageable);//example below<br />  repository.findAll(PageRequest.of(1, 20));<br /><br />long countByLastname(String lastname); // we can use any field name in place of Lastname<br /><br />long deleteByLastname(String lastname);<br />List&lt;User&gt; removeByLastname(String lastname);</pre><h4>Query Methods:</h4><pre>List&lt;Person&gt; findByLastname(String lastname);<br />Optional&lt;T&gt; findById(ID id);<br />User findByEmailAddress(EmailAddress emailAddress);<br /><br />List&lt;Person&gt; findByEmailAddressAndLastname(EmailAddress emailAddress, String lastname);<br /><br />// Enables the distinct flag for the query<br />List&lt;Person&gt; findDistinctPeopleByLastnameOrFirstname(String lastname, String firstname);<br />List&lt;Person&gt; findPeopleDistinctByLastnameOrFirstname(String lastname, String firstname);<br /><br />// Enabling ignoring case for an individual property<br />List&lt;Person&gt; findByLastnameIgnoreCase(String lastname);<br />// Enabling ignoring case for all suitable properties<br />List&lt;Person&gt; findByLastnameAndFirstnameAllIgnoreCase(String lastname, String firstname);<br /><br />// Enabling static ORDER BY for a query<br />List&lt;Person&gt; findByLastnameOrderByFirstnameAsc(String lastname);<br />List&lt;Person&gt; findByLastnameOrderByFirstnameDesc(String lastname);</pre><p>In the above example we can create the methods in interface as we need using the Distinct flag, Ignore Case and order BY. Also, we can use And, Or to pass multiple parameters to the¬†method.</p><h4>Property Expressions:</h4><p>If you have a case where you want to get a entity based on nested property for example we want to get list of People who has a given zipcode, Zipcode is present inside Address. So this case we can use the below¬†code.</p><pre>List&lt;Person&gt; findByAddressZipCode(ZipCode zipCode);//better way<br />List&lt;Person&gt; findByAddress_ZipCode(ZipCode zipCode);//also correct</pre><h4>Special Parameter handling:</h4><pre>Page&lt;User&gt; findByLastname(String lastname, Pageable pageable);<br /><br />Slice&lt;User&gt; findByLastname(String lastname, Pageable pageable);<br /><br />List&lt;User&gt; findByLastname(String lastname, Sort sort);<br /><br />List&lt;User&gt; findByLastname(String lastname, Pageable pageable);<br /><br />//SORT example<br />Sort sort = Sort.by(&quot;firstname&quot;).ascending()<br />  .and(Sort.by(&quot;lastname&quot;).descending());<br /><br />TypedSort&lt;Person&gt; person = Sort.sort(Person.class);<br /><br />Sort sort = person.by(Person::getFirstname).ascending()<br />  .and(person.by(Person::getLastname).descending());</pre><p>Limiting Query¬†Results:</p><pre>User findFirstByOrderByLastnameAsc();<br /><br />User findTopByOrderByAgeDesc();<br /><br />Page&lt;User&gt; queryFirst10ByLastname(String lastname, Pageable pageable);<br /><br />Slice&lt;User&gt; findTop3ByLastname(String lastname, Pageable pageable);<br /><br />List&lt;User&gt; findFirst10ByLastname(String lastname, Sort sort);<br /><br />List&lt;User&gt; findTop10ByLastname(String lastname, Pageable pageable);</pre><h4>Streamble:</h4><p>Now I came across a point where we need to get entities based on condition if name contains two letters in it I need¬†them.</p><pre>interface PersonRepository extends Repository&lt;Person, Long&gt; {<br />  Streamable&lt;Person&gt; findByFirstnameContaining(String firstname);<br />  Streamable&lt;Person&gt; findByLastnameContaining(String lastname);<br />}<br /><br />Streamable&lt;Person&gt; result = repository.findByFirstnameContaining(&quot;av&quot;)<br />  .and(repository.findByLastnameContaining(&quot;ea&quot;));</pre><h4>Streaming Query¬†Results:</h4><p>We can run the Query as¬†below.</p><pre>@Query(&quot;select u from User u&quot;)<br />Stream&lt;User&gt; findAllByCustomQueryAndStream();<br /><br />Stream&lt;User&gt; readAllByFirstnameNotNull();<br /><br />@Query(&quot;select u from User u&quot;)<br />Stream&lt;User&gt; streamAllPaged(Pageable pageable);</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*xRM4Yl-7iAlsQz57" /><figcaption>Photo by <a href="https://unsplash.com/@anagani_saikiran?utm_source=medium&amp;utm_medium=referral">Sai Kiran Anagani</a> on¬†<a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption></figure><h4>Asynchronous Query¬†Results:</h4><p>Asynchronous way to run¬†Queries.</p><pre>@Async<br />Future&lt;User&gt; findByFirstname(String firstname);<br /><br />@Async<br />CompletableFuture&lt;User&gt; findOneByFirstname(String firstname);<br /><br />//useage<br />CompletableFuture&lt;User&gt; user= findByFirstname(&quot;Macintosh&quot;);<br />user(System.out::println);</pre><h4>Referances:</h4><p><a href="https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.core-concepts">docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.core-concepts</a></p><p><a href="https://guttikondaparthasai.medium.com/">Pardhu Guttikonda - Medium</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/0*CoIY3qByEh7AlH75" /><figcaption>Photo by <a href="https://unsplash.com/@wilhelmgunkel?utm_source=medium&amp;utm_medium=referral">Wilhelm Gunkel</a> on¬†<a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral">Unsplash</a></figcaption></figure><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=59025a1e8894" width="1" />
